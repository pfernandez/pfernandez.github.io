import{n as d,C as u,a as s,H as f,o as g,b as w,e as n}from"./index-qNrukWGA.js";import"./index-DkSxGWYw.js";class a extends d{constructor(){super(...arguments),this.color={cell:"",row:"",col:[]},this.hasColor=!1}EndEntry(){super.EndEntry();const o=this.row[this.row.length-1],t=this.color.cell||this.color.row||this.color.col[this.row.length-1];t&&(o.attributes.set("mathbackground",t),this.color.cell="",this.hasColor=!0)}EndRow(){super.EndRow(),this.color.row=""}createMml(){const o=super.createMml();let t=o.isKind("mrow")?o.childNodes[1]:o;if(t.isKind("mstyle")&&(t=t.childNodes[0].childNodes[0]),t.isKind("menclose")&&(t=t.childNodes[0].childNodes[0]),this.hasColor){const l=t.attributes;l.get("frame")==="none"&&l.get("data-frame-styles")===void 0&&l.set("data-frame-styles","")}return o}}function i(r,o,t){const l=r.configuration.packageData.get("color").model,h=r.GetBrackets(o,""),c=l.getColor(h,r.GetArgument(o)),e=r.stack.Top();if(!(e instanceof a))throw new n("UnsupportedTableColor","Unsupported use of %1",r.currentCS);if(t==="col"){if(e.table.length&&e.color.col[e.row.length]!==c)throw new n("ColumnColorNotTop","%1 must be in the top row or preamble",o);e.color.col[e.row.length]=c,r.GetBrackets(o,"")&&r.GetBrackets(o,"")}else if(e.color[t]=c,t==="row"&&(e.Size()||e.row.length))throw new n("RowColorNotFirst","%1 must be at the beginning of a row",o)}new w("colortbl",{cellcolor:[i,"cell"],rowcolor:[i,"row"],columncolor:[i,"col"]});const m=function(r,o){o.parseOptions.packageData.has("color")||g.get("color").config(r,o)},p=u.create("colortbl",{[s.HANDLER]:{[f.MACRO]:["colortbl"]},[s.ITEMS]:{array:a},[s.PRIORITY]:10,[s.CONFIG]:[m,10]});export{a as ColorArrayItem,p as ColortblConfiguration};
