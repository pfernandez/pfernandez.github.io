import{i as m,j as y,c as i,k as M,l as P,B as p,b as B,M as C,C as N,a as f,H as g}from"./index-qNrukWGA.js";import"./index-DkSxGWYw.js";const d=M(P.thinmathspace);class b extends m{constructor(){super(...arguments),this.barNodes=[]}get kind(){return"braket"}get isOpen(){return!0}checkItem(r){return r.isKind("close")?r.getProperty("braketbar")?(this.barNodes.push(...super.toMml(!0,!0).childNodes),this.Clear(),m.fail):[[this.factory.create("mml",this.toMml())],!0]:r.isKind("mml")?(this.Push(r.toMml()),this.getProperty("single")?[[this.toMml()],!0]:m.fail):super.checkItem(r)}toMml(r=!0,s){let o=super.toMml(r,s);if(!r)return o;const e=this.getProperty("open"),n=this.getProperty("close");if(this.barNodes.length&&(o=this.create("node","inferredMrow",[...this.barNodes,o])),this.getProperty("stretchy"))return this.getProperty("space")&&(o=this.create("node","inferredMrow",[this.create("token","mspace",{width:d}),o,this.create("token","mspace",{width:d})])),y.fenced(this.factory.configuration,e,o,n);const c={fence:!0,stretchy:!1,symmetric:!0,texClass:i.OPEN},l=this.create("token","mo",c,e);c.texClass=i.CLOSE;const u=this.create("token","mo",c,n);return this.create("node","mrow",[l,o,u],{open:e,close:n})}}const a={Braket(t,r,s,o,e,n,c=!1){const l=t.i;t.GetArgument(r),t.i=l;const u=t.GetNext();let h=!0;u==="{"&&(t.i++,h=!1);const k=t.itemFactory.create("braket");k.setProperties({barcount:0,barmax:n,open:s,close:o,stretchy:e,single:h,space:c}),t.Push(k),k.env.braketItem=t.stack.height-1},Bar(t,r){let s=r==="|"?"|":"‖";const o=t.stack.height-t.stack.env.braketItem,e=t.stack.Top(o);if(!e||!e.isKind("braket")||e.getProperty("barcount")>=e.getProperty("barmax"))return!1;if(s==="|"&&t.GetNext()==="|"&&(t.i++,s="‖"),!e.getProperty("stretchy")){const c=t.create("token","mo",{stretchy:!1,"data-braketbar":!0,texClass:i.ORD},s);return t.Push(c),!0}const n=t.itemFactory.create("close").setProperty("braketbar",!0);return t.Push(n),e.barNodes.push(t.create("node","TeXAtom",[],{texClass:i.CLOSE}),t.create("token","mo",{stretchy:!0,"data-braketbar":!0,texClass:i.BIN},s),t.create("node","TeXAtom",[],{texClass:i.OPEN})),e.setProperty("barcount",e.getProperty("barcount")+1),!0},Macro:p.Macro};new B("Braket-macros",{bra:[a.Macro,"{\\langle {#1} \\vert}",1],ket:[a.Macro,"{\\vert {#1} \\rangle}",1],braket:[a.Braket,"⟨","⟩",!1,1/0],set:[a.Braket,"{","}",!1,1],Bra:[a.Macro,"{\\left\\langle {#1} \\right\\vert}",1],Ket:[a.Macro,"{\\left\\vert {#1} \\right\\rangle}",1],Braket:[a.Braket,"⟨","⟩",!0,1/0],Set:[a.Braket,"{","}",!0,1,!0],ketbra:[a.Macro,"{\\vert {#1} \\rangle\\langle {#2} \\vert}",2],Ketbra:[a.Macro,"{\\left\\vert {#1} \\right\\rangle\\left\\langle {#2} \\right\\vert}",2],"|":a.Bar});new C("Braket-characters",{"|":a.Bar});const x=N.create("braket",{[f.HANDLER]:{[g.CHARACTER]:["Braket-characters"],[g.MACRO]:["Braket-macros"]},[f.ITEMS]:{[b.prototype.kind]:b},[f.PRIORITY]:3});export{x as BraketConfiguration};
