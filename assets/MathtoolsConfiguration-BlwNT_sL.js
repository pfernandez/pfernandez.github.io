import{U as A,T as b,e as h,H as x,r as U,s as O,j as u,t as X,B as R,N as c,c as D,q as B,u as V,k as H,b as G,h as C,E as W,P as q,D as _,v as T,C as j,a as y,p as F}from"./index-qNrukWGA.js";import{NewcommandConfig as z}from"./NewcommandConfiguration-Br7R5afP.js";import{b as w,a as I}from"./NewcommandUtil-D3UYa-Vw.js";import{A as S}from"./AmsMethods-6XJX1NdH.js";import{N as Y}from"./NewcommandMethods-BDZl_aKP.js";import{M as K}from"./AmsItems-NuYjO1V3.js";import"./index-DkSxGWYw.js";const d={setDisplayLevel(t,e){if(!e)return;const[n,l]=O(e,{"\\displaystyle":[!0,0],"\\textstyle":[!1,0],"\\scriptstyle":[!1,1],"\\scriptscriptstyle":[!1,2]},[null,null]);n!==null&&(t.attributes.set("displaystyle",n),t.attributes.set("scriptlevel",l))},checkAlignment(t,e){const n=t.stack.Top();if(n.kind!==U.prototype.kind)throw new h("NotInAlignment","%1 can only be used in aligment environments",e);return n},addPairedDelims(t,e,n){if(t.configuration.handlers.get(x.MACRO).contains(e))throw new h("CommadExists","Command %1 already defined",`\\${e}`);w.addMacro(t,e,o.PairedDelimiters,n)},spreadLines(t,e){if(!t.isKind("mtable"))return;let n=t.attributes.get("rowspacing");const l=A.dimen2em(e);n=n.split(/ /).map(i=>A.em(Math.max(0,A.dimen2em(i)+l))).join(" "),t.attributes.set("rowspacing",n)},plusOrMinus(t,e){if(e=e.trim(),!e.match(/^[-+]?(?:\d+(?:\.\d*)?|\.\d+)$/))throw new h("NotANumber","Argument to %1 is not a number",t);return e.match(/^[-+]/)?e:"+"+e},getScript(t,e,n){let l=A.trimSpaces(t.GetArgument(e));if(l==="")return t.create("node","none");const i=t.options.mathtools[`prescript-${n}-format`];i&&(l=`${i}{${l}}`);const a=new b(l,t.stack.env,t.configuration).mml();return a.isKind("TeXAtom")&&a.childNodes[0].childNodes.length===0?t.create("node","none"):a}},E={[x.MACRO]:["mathtools-legacycolonsymbols"]},$=X.DEFAULTPRIORITY-1,o={MtMatrix(t,e,n,l){const i=t.GetBrackets(`\\begin{${e.getName()}}`,"c");return o.Array(t,e,n,l,i)},MtSmallMatrix(t,e,n,l,i){return i||(i=t.GetBrackets(`\\begin{${e.getName()}}`,t.options.mathtools["smallmatrix-align"])),o.Array(t,e,n,l,i,A.em(1/3),".2em","S",1)},MtMultlined(t,e){const n=`\\begin{${e.getName()}}`;let l=t.options.mathtools["multlined-pos"]||"c",i=t.options.mathtools["multlined-width"]||"";if(!t.nextIsSpace()){const s=t.GetBrackets(n,l);if(s.match(/^[ctb]$/)?(l=s,i=t.nextIsSpace()?"":t.GetBrackets(n,"")):i=s,i&&!A.matchDimen(i)[0])throw new h("BadWidth","Width for %1 must be a dimension",n)}t.Push(e);const a=t.itemFactory.create("multlined",t,e);return a.arraydef={displaystyle:!0,rowspacing:".5em",width:i||"auto",columnwidth:"100%"},u.setArrayAlign(a,l)},HandleShove(t,e,n){const l=t.stack.Top();if(l.kind!=="multline"&&l.kind!=="multlined")throw new h("CommandInMultlined","%1 can only appear within the multline or multlined environments",e);if(l.Size())throw new h("CommandAtTheBeginingOfLine","%1 must come at the beginning of the line",e);l.setProperty("shove",n);const i=t.GetBrackets(e);let a=t.ParseArg(e);if(i){const s=t.create("node","mrow",[]),r=t.create("node","mspace",[],{width:i});n==="left"?(s.appendChild(r),s.appendChild(a)):(s.appendChild(a),s.appendChild(r)),a=s}t.Push(a)},SpreadLines(t,e){if(t.stack.env.closing===e.getName()){delete t.stack.env.closing;const n=t.stack.Pop(),l=n.toMml(),i=n.getProperty("spread");if(l.isInferred)for(const a of c.getChildren(l))d.spreadLines(a,i);else d.spreadLines(l,i);t.Push(l)}else{const n=t.GetDimen(`\\begin{${e.getName()}}`);e.setProperty("spread",n),e.setProperty("nestStart",!0),u.checkEqnEnv(t),t.Push(e)}},Cases(t,e,n,l,i){const a=t.itemFactory.create("array").setProperty("casesEnv",e.getName());return a.arraydef={rowspacing:".2em",columnspacing:"1em",columnalign:"left"},i==="D"&&(a.arraydef.displaystyle=!0),a.setProperties({open:n,close:l}),t.Push(e),a},MathLap(t,e,n,l){const i=t.GetBrackets(e,"").trim(),a=t.create("node","mstyle",[t.create("node","mpadded",[t.ParseArg(e)],Object.assign({width:0},n==="r"?{}:{lspace:n==="l"?"-1width":"-.5width"}))],{"data-cramped":l});d.setDisplayLevel(a,i),t.Push(t.create("node","TeXAtom",[a]))},Cramped(t,e){const n=t.GetBrackets(e,"").trim(),l=t.ParseArg(e),i=t.create("node","mstyle",[l],{"data-cramped":!0});d.setDisplayLevel(i,n),t.Push(i)},MtLap(t,e,n){const l=u.internalMath(t,t.GetArgument(e),0),i=t.create("node","mpadded",l,{width:0});n!=="r"&&c.setAttribute(i,"lspace",n==="l"?"-1width":"-.5width"),t.Push(i)},MathMakeBox(t,e){const n=t.GetBrackets(e),l=t.GetBrackets(e,"c"),i=t.create("node","mpadded",[t.ParseArg(e)]);n&&c.setAttribute(i,"width",n);const a=O(l.toLowerCase(),{c:"center",r:"right"},"");a&&c.setAttribute(i,"data-align",a),l.toLowerCase()!==l&&c.setAttribute(i,"data-overflow","linebreak"),t.Push(i)},MathMBox(t,e){t.Push(t.create("node","mrow",[t.ParseArg(e)]))},UnderOverBracket(t,e){const n=V(t.GetBrackets(e,".1em"),.1),l=t.GetBrackets(e,".2em"),i=t.GetArgument(e),[a,s,r]=e.charAt(1)==="o"?["over","accent","bottom"]:["under","accentunder","top"],m=H(n),g=new b(i,t.stack.env,t.configuration).mml(),f=new b(i,t.stack.env,t.configuration).mml(),M=t.create("node","mpadded",[t.create("node","mphantom",[f])],{style:`border: ${m} solid; border-${r}: none`,height:l,depth:0}),P=u.underOver(t,g,M,a,!0),v=c.getChildAt(c.getChildAt(P,0),0);c.setAttribute(v,s,!0),t.Push(P)},Aboxed(t,e,n="boxed",l=!0){const i=d.checkAlignment(t,e);i.row.length%2===1&&i.row.push(t.create("node","mtd",[]));const a=t.GetArgument(e),s=t.string.substring(t.i);t.string=a+"&&\\endAboxed",t.i=0;const r=t.GetUpTo(e,"&"),m=t.GetUpTo(e,"&");t.GetUpTo(e,"\\endAboxed");const[g,f]=l?["",""]:["$\\displaystyle{","}$"],M=u.substituteArgs(t,[r,m],`\\rlap{\\${n}{${g}#1{}#2${f}}}\\kern.267em\\phantom{#1}&\\phantom{{}#2}\\kern.267em`);t.string=M+s,t.i=0},MakeAboxedCommand(t,e){const n=t.GetStar(),l=w.GetCSname(t,e),i=w.GetCSname(t,e+"\\"+l),a=t.configuration.handlers;if(a.get(x.MACRO).lookup(l))throw new h("AlreadyDefined","%1 is already defined","\\"+l);a.retrieve(I.NEW_COMMAND).add(l,new B(l,o.Aboxed,[i,n])),t.Push(t.itemFactory.create("null"))},ArrowBetweenLines(t,e){const n=d.checkAlignment(t,e);if(n.Size()||n.row.length)throw new h("BetweenLines","%1 must be on a row by itself",e);const l=t.GetStar(),i=t.GetBrackets(e,"\\Updownarrow");l&&(n.EndEntry(),n.EndEntry());const a=l?"\\quad"+i:i+"\\quad",s=new b(a,t.stack.env,t.configuration).mml();t.Push(s),n.EndEntry(),n.EndRow()},VDotsWithin(t,e){const n="\\mmlToken{mi}{}"+t.GetArgument(e)+"\\mmlToken{mi}{}",l=new b(n,t.stack.env,t.configuration).mml(),i=t.create("node","mpadded",[t.create("node","mpadded",[t.create("node","mo",[t.create("text","⋮")])],{width:0,lspace:"-.5width"}),t.create("node","mphantom",[l])],{lspace:".5width"});t.Push(i)},ShortVDotsWithin(t,e){const n=t.stack.Top(),l=t.GetStar();n.EndEntry&&(o.FlushSpaceAbove(t,"\\MTFlushSpaceAbove"),l||n.EndEntry()),o.VDotsWithin(t,"\\vdotswithin"),n.EndEntry&&(l&&n.EndEntry(),o.FlushSpaceBelow(t,"\\MTFlushSpaceBelow"))},FlushSpaceAbove(t,e){const n=d.checkAlignment(t,e);n.table&&(n.setProperty("flushspaceabove",n.table.length),n.addRowSpacing("-"+t.options.mathtools.shortvdotsadjustabove))},FlushSpaceBelow(t,e){const n=d.checkAlignment(t,e);n.table&&(n.Size()&&n.EndEntry(),n.EndRow(),n.addRowSpacing("-"+t.options.mathtools.shortvdotsadjustbelow))},PairedDelimiters(t,e,n,l,i="#1",a=1,s="",r=""){const m=t.GetStar(),g=m?"":t.GetBrackets(e),[f,M,P]=m?["\\mathopen{\\left","\\right","}\\mathclose{}"]:g?[g+"l",g+"r",""]:["","",""],v=m?"\\middle":g||"";if(a){const p=[];for(let k=p.length;k<a;k++)p.push(t.GetArgument(e));s=u.substituteArgs(t,p,s),i=u.substituteArgs(t,p,i),r=u.substituteArgs(t,p,r)}i=i.replace(/\\delimsize/g,v),t.string=[s,f,n,i,M,l,P,r,t.string.substring(t.i)].reduce((p,k)=>u.addArgs(t,p,k),""),t.i=0,u.checkMaxMacros(t)},DeclarePairedDelimiter(t,e){const n=w.GetCsNameArgument(t,e),l=t.GetArgument(e),i=t.GetArgument(e);d.addPairedDelims(t,n,[l,i]),t.Push(t.itemFactory.create("null"))},DeclarePairedDelimiterX(t,e){const n=w.GetCsNameArgument(t,e),l=w.GetArgCount(t,e),i=t.GetArgument(e),a=t.GetArgument(e),s=t.GetArgument(e);d.addPairedDelims(t,n,[i,a,s,l]),t.Push(t.itemFactory.create("null"))},DeclarePairedDelimiterXPP(t,e){const n=w.GetCsNameArgument(t,e),l=w.GetArgCount(t,e),i=t.GetArgument(e),a=t.GetArgument(e),s=t.GetArgument(e),r=t.GetArgument(e),m=t.GetArgument(e);d.addPairedDelims(t,n,[a,s,m,l,i,r]),t.Push(t.itemFactory.create("null"))},CenterColon(t,e,n,l=!1,i=!1){const a=t.options.mathtools;let s=t.create("token","mo",{},":");if(n&&(a.centercolon||l)){const r=a["centercolon-offset"];s=t.create("node","mpadded",[s],Object.assign({voffset:r,height:`+${r}`,depth:`-${r}`},i?{width:a["thincolon-dw"],lspace:a["thincolon-dx"]}:{}))}t.Push(s)},Relation(t,e,n,l){t.options.mathtools["use-unicode"]&&l?t.Push(t.create("token","mo",{texClass:D.REL},l)):(n="\\mathrel{"+n.replace(/:/g,"\\MTThinColon").replace(/-/g,"\\mathrel{-}")+"}",t.string=u.addArgs(t,n,t.string.substring(t.i)),t.i=0)},NArrow(t,e,n,l){t.Push(t.create("node","TeXAtom",[t.create("token","mtext",{},n),t.create("node","mpadded",[t.create("node","mpadded",[t.create("node","menclose",[t.create("node","mspace",[],{height:".2em",depth:0,width:".4em"})],{notation:"updiagonalstrike","data-thickness":".05em","data-padding":0})],{width:0,lspace:"-.5width",voffset:l}),t.create("node","mphantom",[t.create("token","mtext",{},n)])],{width:0,lspace:"-.5width"})],{texClass:D.REL}))},SplitFrac(t,e,n){const l=t.ParseArg(e),i=t.ParseArg(e);t.Push(t.create("node","mstyle",[t.create("node","mfrac",[t.create("node","mstyle",[l,t.create("token","mi"),t.create("token","mspace",{width:"1em"})],{scriptlevel:0}),t.create("node","mstyle",[t.create("token","mspace",{width:"1em"}),t.create("token","mi"),i],{scriptlevel:0})],{linethickness:0,numalign:"left",denomalign:"right"})],{displaystyle:n,scriptlevel:0}))},XMathStrut(t,e){let n=t.GetBrackets(e),l=t.GetArgument(e);l=d.plusOrMinus(e,l),n=d.plusOrMinus(e,n||l),t.Push(t.create("node","TeXAtom",[t.create("node","mpadded",[t.create("node","mphantom",[t.create("token","mo",{stretchy:!1},"(")])],{width:0,height:l+"height",depth:n+"depth"})],{texClass:D.ORD}))},Prescript(t,e){const n=d.getScript(t,e,"sup"),l=d.getScript(t,e,"sub"),i=d.getScript(t,e,"arg");if(c.isType(n,"none")&&c.isType(l,"none")){t.Push(i);return}const a=t.create("node","mmultiscripts",[i]);c.getChildren(a).push(null,null),c.appendChildren(a,[t.create("node","mprescripts"),l,n]),a.setProperty("fixPrescript",!0),t.Push(a)},NewTagForm(t,e,n=!1){const l=t.tags;if(!("mtFormats"in l))throw new h("TagsNotMT","%1 can only be used with ams or mathtools tags",e);const i=t.GetArgument(e).trim();if(!i)throw new h("InvalidTagFormID","Tag form name can't be empty");const a=t.GetBrackets(e,""),s=t.GetArgument(e),r=t.GetArgument(e);if(!n&&l.mtFormats.has(i))throw new h("DuplicateTagForm","Duplicate tag form: %1",i);l.mtFormats.set(i,[s,r,a]),t.Push(t.itemFactory.create("null"))},UseTagForm(t,e){const n=t.tags;if(!("mtFormats"in n))throw new h("TagsNotMT","%1 can only be used with ams or mathtools tags",e);const l=t.GetArgument(e).trim();if(!l){n.mtCurrent=null,t.Push(t.itemFactory.create("null"));return}if(!n.mtFormats.has(l))throw new h("UndefinedTagForm","Undefined tag form: %1",l);n.mtCurrent=n.mtFormats.get(l),t.Push(t.itemFactory.create("null"))},SetOptions(t,e){const n=t.options.mathtools;if(!n["allow-mathtoolsset"])throw new h("ForbiddenMathtoolsSet","%1 is disabled",e);const l={};Object.keys(n).forEach(s=>{s!=="pariedDelimiters"&&s!=="tagforms"&&s!=="allow-mathtoolsset"&&(l[s]=1)});const i=t.GetArgument(e),a=u.keyvalOptions(i,l,!0);for(const s of Object.keys(a))s==="legacycolonsymbols"&&n[s]!==a[s]&&(n[s]?t.configuration.handlers.remove(E,{}):t.configuration.handlers.add(E,{},$)),n[s]=a[s];t.Push(t.itemFactory.create("null"))},Array:R.Array,Macro:R.Macro,xArrow:S.xArrow,HandleRef:S.HandleRef,AmsEqnArray:S.AmsEqnArray,MacroWithTemplate:Y.MacroWithTemplate};new G("mathtools-macros",{shoveleft:[o.HandleShove,C.Align.LEFT],shoveright:[o.HandleShove,C.Align.RIGHT],xleftrightarrow:[o.xArrow,8596,10,10],xLeftarrow:[o.xArrow,8656,12,7],xRightarrow:[o.xArrow,8658,7,12],xLeftrightarrow:[o.xArrow,8660,12,12],xhookleftarrow:[o.xArrow,8617,10,5],xhookrightarrow:[o.xArrow,8618,5,10],xmapsto:[o.xArrow,8614,10,10],xrightharpoondown:[o.xArrow,8641,5,10],xleftharpoondown:[o.xArrow,8637,10,5],xrightleftharpoons:[o.xArrow,8652,10,10],xrightharpoonup:[o.xArrow,8640,5,10],xleftharpoonup:[o.xArrow,8636,10,5],xleftrightharpoons:[o.xArrow,8651,10,10],xlongrightarrow:[o.xArrow,10230,7,12,1.45],xlongleftarrow:[o.xArrow,10229,12,7,1.45],xLongrightarrow:[o.xArrow,10233,7,12,1.45],xLongleftarrow:[o.xArrow,10232,12,7,1.45],mathllap:[o.MathLap,"l",!1],mathrlap:[o.MathLap,"r",!1],mathclap:[o.MathLap,"c",!1],clap:[o.MtLap,"c"],textllap:[o.MtLap,"l"],textrlap:[o.MtLap,"r"],textclap:[o.MtLap,"c"],cramped:o.Cramped,crampedllap:[o.MathLap,"l",!0],crampedrlap:[o.MathLap,"r",!0],crampedclap:[o.MathLap,"c",!0],crampedsubstack:[o.Macro,"\\begin{crampedsubarray}{c}#1\\end{crampedsubarray}",1],mathmbox:o.MathMBox,mathmakebox:o.MathMakeBox,overbracket:o.UnderOverBracket,underbracket:o.UnderOverBracket,refeq:o.HandleRef,MoveEqLeft:[o.Macro,"\\hspace{#1em}&\\hspace{-#1em}",1,"2"],Aboxed:o.Aboxed,MakeAboxedCommand:o.MakeAboxedCommand,ArrowBetweenLines:o.ArrowBetweenLines,vdotswithin:o.VDotsWithin,shortvdotswithin:o.ShortVDotsWithin,MTFlushSpaceAbove:o.FlushSpaceAbove,MTFlushSpaceBelow:o.FlushSpaceBelow,DeclarePairedDelimiter:o.DeclarePairedDelimiter,DeclarePairedDelimiterX:o.DeclarePairedDelimiterX,DeclarePairedDelimiterXPP:o.DeclarePairedDelimiterXPP,DeclarePairedDelimiters:o.DeclarePairedDelimiter,DeclarePairedDelimitersX:o.DeclarePairedDelimiterX,DeclarePairedDelimitersXPP:o.DeclarePairedDelimiterXPP,vcentercolon:[o.CenterColon,!0,!0],ordinarycolon:[o.CenterColon,!1],MTThinColon:[o.CenterColon,!0,!0,!0],coloneqq:[o.Relation,":=","≔"],Coloneqq:[o.Relation,"::=","⩴"],coloneq:[o.Relation,":=","≔"],Coloneq:[o.Relation,"::=","⩺"],eqqcolon:[o.Relation,"=:","≕"],Eqqcolon:[o.Relation,"=::"],eqcolon:[o.Relation,"=:","≕"],Eqcolon:[o.Relation,"=::"],colonapprox:[o.Relation,":\\approx"],Colonapprox:[o.Relation,"::\\approx"],colonsim:[o.Relation,":\\sim"],Colonsim:[o.Relation,"::\\sim"],dblcolon:[o.Relation,"::","∷"],approxcolon:[o.Relation,"\\approx:"],Approxcolon:[o.Relation,"\\approx::"],simcolon:[o.Relation,"\\sim:"],Simcolon:[o.Relation,"\\sim::"],colondash:[o.Relation,":-"],Colondash:[o.Relation,"::-"],dashcolon:[o.Relation,"-:","∹"],Dashcolon:[o.Relation,"-::"],nuparrow:[o.NArrow,"↑",".06em"],ndownarrow:[o.NArrow,"↓",".25em"],bigtimes:[o.Macro,"\\mathop{\\Large\\kern-.1em\\boldsymbol{\\times}\\kern-.1em}"],splitfrac:[o.SplitFrac,!1],splitdfrac:[o.SplitFrac,!0],xmathstrut:o.XMathStrut,prescript:o.Prescript,newtagform:[o.NewTagForm,!1],renewtagform:[o.NewTagForm,!0],usetagform:o.UseTagForm,adjustlimits:[o.MacroWithTemplate,"\\mathop{{#1}\\vphantom{{#3}}}_{{#2}\\vphantom{{#4}}}\\mathop{{#3}\\vphantom{{#1}}}_{{#4}\\vphantom{{#2}}}",4,,"_",,"_"],mathtoolsset:o.SetOptions});new G("mathtools-legacycolonsymbols",{coloneq:[o.Relation,":-"],Coloneq:[o.Relation,"::-"],eqcolon:[o.Relation,"-:","∹"],Eqcolon:[o.Relation,"-::"]});new W("mathtools-environments",q.environment,{dcases:[o.Array,null,"\\{","","ll",null,".2em","D"],rcases:[o.Array,null,"","\\}","ll",null,".2em"],drcases:[o.Array,null,"","\\}","ll",null,".2em","D"],"dcases*":[o.Cases,null,"{","","D"],"rcases*":[o.Cases,null,"","}"],"drcases*":[o.Cases,null,"","}","D"],"cases*":[o.Cases,null,"{",""],"matrix*":[o.MtMatrix,null,null,null],"pmatrix*":[o.MtMatrix,null,"(",")"],"bmatrix*":[o.MtMatrix,null,"[","]"],"Bmatrix*":[o.MtMatrix,null,"\\{","\\}"],"vmatrix*":[o.MtMatrix,null,"\\vert","\\vert"],"Vmatrix*":[o.MtMatrix,null,"\\Vert","\\Vert"],"smallmatrix*":[o.MtSmallMatrix,null,null,null],psmallmatrix:[o.MtSmallMatrix,null,"(",")","c"],"psmallmatrix*":[o.MtSmallMatrix,null,"(",")"],bsmallmatrix:[o.MtSmallMatrix,null,"[","]","c"],"bsmallmatrix*":[o.MtSmallMatrix,null,"[","]"],Bsmallmatrix:[o.MtSmallMatrix,null,"\\{","\\}","c"],"Bsmallmatrix*":[o.MtSmallMatrix,null,"\\{","\\}"],vsmallmatrix:[o.MtSmallMatrix,null,"\\vert","\\vert","c"],"vsmallmatrix*":[o.MtSmallMatrix,null,"\\vert","\\vert"],Vsmallmatrix:[o.MtSmallMatrix,null,"\\Vert","\\Vert","c"],"Vsmallmatrix*":[o.MtSmallMatrix,null,"\\Vert","\\Vert"],crampedsubarray:[o.Array,null,null,null,null,"0em","0.1em","S'",1],multlined:o.MtMultlined,spreadlines:[o.SpreadLines,!0],lgathered:[o.AmsEqnArray,null,null,null,"l","t",null,".5em","D"],rgathered:[o.AmsEqnArray,null,null,null,"r","t",null,".5em","D"]});new _("mathtools-delimiters",q.delimiter,{"\\lparen":"(","\\rparen":")"});new G("mathtools-characters",{":":[o.CenterColon,!0]});let L=0;function J(t,e){const n=e.parseOptions.options.tags;n!=="base"&&Object.hasOwn(t.tags,n)&&T.add(n,t.tags[n]);const l=T.create(e.parseOptions.options.tags).constructor;class i extends l{constructor(){super(),this.mtFormats=new Map,this.mtCurrent=null;const r=e.parseOptions.options.mathtools.tagforms;for(const m of Object.keys(r)){if(!Array.isArray(r[m])||r[m].length!==3)throw new h("InvalidTagFormDef",'The tag form definition for "%1" should be an array of three strings',m);this.mtFormats.set(m,r[m])}}formatTag(r){if(this.mtCurrent){const[m,g,f]=this.mtCurrent;return[m,f?`${f}{${r}}`:r,g]}return super.formatTag(r)}}L++;const a="MathtoolsTags-"+L;T.add(a,i),e.parseOptions.options.tags=a}class N extends K{get kind(){return"multlined"}EndTable(){if((this.Size()||this.row.length)&&(this.EndEntry(),this.EndRow()),this.table.length>1){const e=this.factory.configuration.options.mathtools,n=e["multlined-gap"],l=e["firstline-afterskip"]||n,i=e["lastline-preskip"]||n,a=c.getChildren(this.table[0])[0];c.getAttribute(a,"columnalign")!==C.Align.RIGHT&&a.appendChild(this.create("node","mspace",[],{width:l}));const s=c.getChildren(this.table[this.table.length-1])[0];if(c.getAttribute(s,"columnalign")!==C.Align.LEFT){const r=c.getChildren(s)[0];r.childNodes.unshift(null);const m=this.create("node","mspace",[],{width:i});c.setChild(r,0,m)}}super.EndTable.call(this)}}function Q(t,e){z(t,e);const n=e.parseOptions,l=n.options.mathtools.pairedDelimiters,i=t.handlers.retrieve(I.NEW_COMMAND);for(const[a,s]of Object.entries(l))i.add(a,new B(a,o.PairedDelimiters,s));n.options.mathtools.legacycolonsymbols&&t.handlers.add(E,{},$),J(t,e)}function Z({data:t}){for(const e of t.getList("mmultiscripts")){if(!e.getProperty("fixPrescript"))continue;const n=c.getChildren(e);let l=0;for(const i of[1,2])n[i]||(c.setChild(e,i,t.nodeFactory.create("node","none")),l++);l===2&&n.splice(1,2)}}const st=j.create("mathtools",{[y.HANDLER]:{macro:["mathtools-macros","mathtools-delimiters"],[x.ENVIRONMENT]:["mathtools-environments"],[x.DELIMITER]:["mathtools-delimiters"],[x.CHARACTER]:["mathtools-characters"]},[y.ITEMS]:{[N.prototype.kind]:N},[y.CONFIG]:Q,[y.POSTPROCESSORS]:[[Z,-6]],[y.OPTIONS]:{mathtools:{"multlined-gap":"1em","multlined-pos":"c","multlined-width":"","firstline-afterskip":"","lastline-preskip":"","smallmatrix-align":"c",shortvdotsadjustabove:".2em",shortvdotsadjustbelow:".2em",centercolon:!1,"centercolon-offset":".04em","thincolon-dx":"-.04em","thincolon-dw":"-.08em","use-unicode":!1,legacycolonsymbols:!1,"prescript-sub-format":"","prescript-sup-format":"","prescript-arg-format":"","allow-mathtoolsset":!0,pairedDelimiters:F({}),tagforms:F({})}}});export{st as MathtoolsConfiguration,Z as fixPrescripts};
